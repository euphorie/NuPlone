<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      xmlns:meta="http://xml.zope.org/namespaces/meta"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      i18n:domain="nuplone"
      meta:interpolation="true"
      metal:use-macro="context/@@layout/macros/layout">

  <metal:title fill-slot="title">${view/label}</metal:title>
  <metal:content fill-slot="content">
     <div class="message ${python:'error' if errors else 'notice'}"
         tal:define="
           status view/status;
           errors view/widgets/errors;
         "
         tal:condition="status"
         i18n:domain="plone"
    >
      <p>
        <tal:icon tal:define="
                    icons nocall: context/@@iconresolver;
                  "
                  tal:replace="structure python:icons.tag('plone-statusmessage-error', tag_alt='Error', tag_class='statusmessage-icon')"
        />
        <span class="content"
              i18n:translate=""
        >
          ${structure: status}
        </span>
      </p>
      <ul tal:define="
            display_errors python:[e for e in errors if not getattr(e, 'widget', None)];
          "
          tal:condition="display_errors"
      >
        <li tal:repeat="error display_errors">
          ${error/message}
        </li>
      </ul>
    </div>
    <p class="discrete" tal:condition="python:getattr(view, 'description', None)">${view/description}</p>

    <form class="concise" action="${request/getURL}" enctype="${view/enctype}" method="${view/method}" id="${view/id}">
      <fieldset>
        <tal:widget repeat="widget view/widgets/values" replace="structure widget/render" />
      </fieldset>

      <tal:groupform condition="python:getattr(view, 'groups', None)">
        <fieldset tal:repeat="group view/groups" class="${group/layout|nothing}">
          <legend i18n:domain="plone" i18n:translate="" tal:define="legend group/label" tal:condition="legend">${legend}</legend>
          <p class="discrete" tal:define="description group/description" tal:condition="description">${description}</p>
          <tal:widget repeat="widget group/widgets/values">
            <tal:render replace="structure widget/render" />
          </tal:widget>
        </fieldset>
      </tal:groupform>

      <div class="buttonBar" tal:define="actions view/actions/values|nothing" tal:condition="actions">
        <tal:action repeat="action actions" replace="structure action/render" />
      </div>
    </form>
  </metal:content>
</html>
